<!-- ITEMS search.html.erb -->

<script type="text/javascript">
$(document).ready(function() {

// hide the non-javascript show link
$('.classic_show').hide();
// make the item rows clickable and have a pointer hover-over
$('.item_row').css('cursor', 'pointer').addClass('show_link');

// SHOW ITEM BEHAVIOR
// after clicking "show"
$('.show_link').click(function() {

    // build the url for the item modal show page
    var url_string = "/inventories/" + $(this).attr('data-inventory') + "/items/" + $(this).attr('data-id') + "/show_in_modal";

    // fire the modal
    $('#item-modal').modal({  
      remote: url_string
  });
    // refresh the modal so you can go to multiple items without refreshing the whole page
    setTimeout(
      function() {
         $('#item_show').load(url_string);
     },
     100)
 }); // end click
}); // end ready
</script>

<!-- Modal for items -->
<div id="item-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
    <h3 id="itemModalLabel"></h3>
    </div>
    <div class="modal-body">
    <p></p>
    </div>
</div>
<!-- End modal for items -->

<div class="container">
    <div class="row">
        <div class="span12">
            <h1 align="left">Search Results</h1>
            <div class="pagination" align="left"><%= paginate @search %></div>
            <table class="producer-table table-hover" align="center">
                <tr>
                    <th class="hidden-phone"></th>
                    <th>Name</th>
                    <th>Inventory</th>
                    <th class="hidden-phone">Description</th>
                    <th>Price</th>
                    <th class="hidden-phone">Min Order</th>   
                    <th>Category</th>   
                    <th>Available</th>
                    <th></th>        
                </tr>

                <% @search.results.each do |item| %>
                <tr>
                    <td class="hidden-phone">
                    <% if !(item.item_photo_file_name.nil?) %>
                    <media class="item-search-image item_row" data-id="<%= item.id %>">
                        <%= image_tag(item.item_photo.url(:grid)) %>
                    </media>
                    <%end%>
                </td>

                    <td class="item_row" data-id="<%= item.id %>"><%= item.name %></td>
                    <td><%= link_to(item.inventory.display_name, inventory_path(item.inventory)) %></td>
                    <td class="item_row hidden-phone" data-id="<%= item.id %>"><%= item.description %></td>
                    <td class="item_row" data-id="<%= item.id %>">
                        <%= number_to_currency(item.price) %><b>/<%= item.units.singularize %></b></td>
                    <td class="item_row hidden-phone" data-id="<%= item.id %>"><%= item.minorder %></td>
                    <td class="item_row" data-id="<%= item.id %>"><%= Category.find(item.category_id).name %></td>
                    <td class="item_row" data-id="<%= item.id %>"><%= item.is_available? %></td>
                    <td class="classic_show">
                        <%= link_to "Show", inventory_item_path({ :inventory_id => item.inventory.id, :id => item.id }) %>
                    </td>


                    <% end %>
                </table>

                <div class="pagination" align="left"><%= paginate @search %></div>

            </div>
        </div>
